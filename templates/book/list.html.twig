{% extends 'base.html.twig' %}

{% block body %}
  <!-- Filter section -->
  <section class="py-3">
    {{ form_start(formSearch) }}
    <div class="d-flex align-items-center justify-content-center">
      <div class="mx-2">
        {{ form_widget(formSearch.minPrice) }}
      </div>
      <div class="mx-2">
        {{ form_widget(formSearch.maxPrice) }}
      </div>
      <div class="mx-2">
        {{ form_widget(formSearch.title) }}
      </div>
      <div class="mx-2">
        <button type="submit" class="btn btn-primary">Search</button>
      </div>
    </div>
    {{ form_end(formSearch) }}
  </section>
  <!-- Blog preview section -->
  <section class="py-3">
    <div class="container px-5">
      <h2 class="fw-bolder fs-5 mb-4">
        Book List
      </h2>
      <div class="row gx-5">
        {% for idx, book in books|reverse %}
          <div class="col-lg-3 mb-5">
            <div class="card h-100 shadow border-0">
              <a href="/Book/{{ book.id }}"
                class="text-decoration-none link-dark">
                <img class="card-img-top"
                  src="/images/books/{{ book.imageName }}"
                  alt="book image"
                  height="400" />
                <div class="card-body px-3">
                  <div class="badge bg-primary bg-gradient rounded-pill mb-2">
                    {{ book.genre }}
                  </div>
                  <div class="h5 card-title mb-1 text-info overflow-hidden text-truncate">
                    {{ book.title }}
                  </div>
                  <div class="small">
                    <div class="fw-bold">
                      {{ book.author }}
                    </div>
                  </div>
                  <div class="card-text mb-0">
                    from : <span style="color:#d63384" class="fw-bold">${{
                        book.price|number_format(2)
                      }} <span class="fs-6">usd</span></span>
                  </div>
                </div>
              </a>
              <a href="{{
                app.user
                  ? path(
                    'cart_list',
                    {
                      id: book.id
                    }
                  )
                  : path('login')
                }}"
                class="btn {{
                app.user and app.user.cart and book in app.user.cart.book
                  ? 'btn-outline-primary'
                  : 'btn-primary'
                }}">
                <i class="bi-bag"></i>
                <span class="m-2">
                  {{ app.user and app.user.cart and book in app.user.cart.book
                    ? 'In Cart'
                    : 'Add to Cart' }}
                </span>
              </a>
            </div>
          </div>
        {% endfor %}
        <div class="d-flex justify-content-center">
          {% do books.setPageRange(2) %}
          {{ knp_pagination_render(books, '/pagination.html.twig') }}
        </div>
      </div>
    </div>
  </section>
{% endblock %}
